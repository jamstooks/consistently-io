{% extends "repos/base.html" %}

{% load static %}

{% block content %}

  <div class="badge-box">
    <img id="badge" src="{% static repo.get_badge_path %}" alt="badge" />
  </div>

  {{ block.super }}

  <div class="center-column narrow">
      {% for status in status_list %}
          <div class="status-box {{ status.status }}">
              <div class="status-box-logo {{ status.integration.integration_type }}-integration-background"></div>
              <div class="status-box-icon"></div>
              <div class="status-box-detail">
                  {% if status.value %}
                    {{ status.value|title }}
                  {% else %}
                    {{ status.get_status_display }}
                  {% endif %}
              </div>
          </div>
      {% endfor %}
  </div>
  
  <div id="modal" style="display: none;">
    {% include 'repos/badge_modal.html' %}
  </div>
{% endblock %}

{% block css %}
  {{ block.super }}
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.13.2/tingle.min.css" />
{% endblock %}

{% block js %}
  {{ block.super }}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tingle/0.13.2/tingle.min.js"></script>
  <script>
    // instanciate new modal
    var modal = new tingle.modal({
        footer: false,
        stickyFooter: false,
        closeMethods: ['overlay', 'button', 'escape'],
        closeLabel: "Close",
        cssClass: ['badge-modal'],
    });
    
    // set content
    modal.setContent($('#modal').html());
    
    // add a button
    // modal.addFooterBtn('Button label', 'tingle-btn tingle-btn--primary', function() {
    //     // here goes some logic
    //     modal.close();
    // });
    
    // // add another button
    // modal.addFooterBtn('Dangerous action !', 'tingle-btn tingle-btn--danger', function() {
    //     // here goes some logic
    //     modal.close();
    // });
    
    // open modal
    // modal.open();
    
    // close modal
    // modal.close();
    
    $("#badge").on('click', function() {
      console.log('here');
      modal.open();
    });
  </script>
{% endblock %}
